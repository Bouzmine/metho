<ion-header>
  <ion-navbar>
    <ion-title>
      <div class="page-title"> {{project.name}} </div>
      <div class="page-sub-title"> {{project.matter ? project.matter : ("PROJECT.TAB.UNKNOWN_MATTER" | translate)}} </div>
    </ion-title>
    <ion-buttons end>
      <button ion-button icon-only (click)="share()" [disabled]="!sources.length">
        <ion-icon name="share-alt"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content>
  <ion-searchbar *ngIf="sources.length" [(ngModel)]="searchQuery" (ionInput)="updateSearch($event)" (ionCancel)="updateSearch($event)" cancelButtonText="{{'COMMON.CANCEL' | translate}}" showCancelButton="true" placeholder="{{'PROJECT.DETAIL.SEARCH' |Â translate}}" animated="true"></ion-searchbar>
  <button ion-item color="light" (click)="openPendingPage()" class="pendings" *ngIf="pendingNumber > 0 && searchQuery == ''">
    {{"PROJECT.DETAIL.PENDING_ELEMENTS" | translate}}
    <ion-badge item-right>{{ pendingNumber }}</ion-badge>
  </button>
  <ion-list *ngIf="sources.length">
    <ion-item-sliding *ngFor="let source of filteredSources">
      <button ion-item (click)="openSourcePage(source)">
        <h2 [innerHtml]="source.title ? source.title : source.parsedSource"></h2>
        <p>{{ source.parsedType | translate }}</p>
        <div *ngIf="source.warnings.length" item-right>
          <span>{{ source.warnings.length }}</span>
          <ion-icon name="warning" class="yellow"></ion-icon>
        </div>
        <div *ngIf="source.errors.length" item-right>
          <span>{{ source.errors.length }}</span>
          <ion-icon name="alert" class="red"></ion-icon>
        </div>
      </button>

      <ion-item-options>
        <button ion-button color="primary" (click)="editSource(source)">
          {{"COMMON.EDIT" | translate}}
        </button>
        <button ion-button color="danger" (click)="deleteSource(source)">
          {{"COMMON.DELETE" | translate}}
        </button>
      </ion-item-options>
    </ion-item-sliding>
  </ion-list>

  <div class="flex-full" *ngIf="!sources.length">
    <ion-icon name="filing" isActive="false" class="biggest"></ion-icon>
    <p class="center dimmed-50">
      {{"PROJECT.DETAIL.EMPTY_TAB" | translate}}
    </p>
  </div>

  <div class="flex" padding *ngIf="sources.length && !filteredSources.length">
    <ion-icon name="close-circle" isActive="false" class="big"></ion-icon>
    <p class="center dimmed-50">
      {{"PROJECT.DETAIL.EMPTY_SEARCH" | translate}}
    </p>
  </div>

  <ion-fab bottom right>
    <button ion-fab>
      <ion-icon name="add"></ion-icon>
    </button>
    <ion-fab-list side="top">
      <button ion-fab (click)="openModal('book')">
        <ion-icon name="book"></ion-icon>
        <div class="label">{{'PROJECT.TYPES.BOOK' | translate}}</div>
      </button>
      <button ion-fab (click)="openModal('article')">
        <ion-icon name="paper"></ion-icon>
        <div class="label">{{'PROJECT.TYPES.ARTICLE' | translate}}</div>
      </button>
      <button ion-fab (click)="openModal('internet')">
        <ion-icon name="at"></ion-icon>
        <div class="label">{{'PROJECT.TYPES.INTERNET' | translate}}</div>
      </button>
      <button ion-fab (click)="openModal('cd')">
        <ion-icon name="disc"></ion-icon>
        <div class="label">{{'PROJECT.TYPES.CD' | translate}}</div>
      </button>
      <button ion-fab (click)="openModal('movie')">
        <ion-icon name="film"></ion-icon>
        <div class="label">{{'PROJECT.TYPES.MOVIE' | translate}}</div>
      </button>
      <button ion-fab (click)="openModal('interview')">
        <ion-icon name="quote"></ion-icon>
        <div class="label">{{'PROJECT.TYPES.INTERVIEW' | translate}}</div>
      </button>
    </ion-fab-list>
  </ion-fab>
</ion-content>
